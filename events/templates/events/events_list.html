{% extends 'events/base_dashboard.html' %}
{% block title %}Мероприятия — KINI × Yessenov{% endblock %}
{% block nav_events %}active{% endblock %}

{% block content %}
  <h2>Все мероприятия</h2>
  <table>
    <thead>
      <tr><th>Название</th><th>Дата</th><th>Время</th><th>Место</th><th>Свободно</th><th></th></tr>
    </thead>
    <tbody>
    {% for e in events %}
      <tr>
        <td>{{ e.title }}</td>
        <td>{{ e.date }}</td>
        <td>{{ e.time|default:"—" }}</td>
        <td>{{ e.place|default:"—" }}</td>
        <td>{{ e.capacity|add:-e.registered_count }} / {{ e.capacity }}</td>
        <td>
          <form action="{% url 'register_for_event' e.id %}" method="post" style="margin:0">
            {% csrf_token %}
            <button class="btn" {% if e.is_full %}disabled{% endif %}>
              {% if e.is_full %}Мест нет{% else %}Записаться{% endif %}
            </button>
          </form>
        </td>
      </tr>
    {% empty %}
      <tr><td colspan="6">Пока нет мероприятий.</td></tr>
    {% endfor %}
    </tbody>
  </table>
{% endblock %}