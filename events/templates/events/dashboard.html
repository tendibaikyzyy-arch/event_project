{% load static %}
<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>KINI √ó Yessenov ‚Äî –ö–∞–ª–µ–Ω–¥–∞—Ä—å</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body {
  margin: 0;
  font-family: "Inter", sans-serif;
  background: linear-gradient(135deg, #fff7f0, #eaf7ff, #f5e9ff);
  background-size: 300% 300%;
  animation: gradientMove 15s ease infinite;
}
@keyframes gradientMove {
  0% {background-position: 0% 50%;}
  50% {background-position: 100% 50%;}
  100% {background-position: 0% 50%;}
}

.container {
  display: flex;
  gap: 20px;
  padding: 20px;
}
.sidebar {
  width: 220px;
  background: #fff;
  border-radius: 10px;
  padding: 15px;
  box-shadow: 0 4px 12px rgba(0,0,0,0.1);
}
.sidebar h3 {
  margin-top: 0;
  font-size: 16px;
}
.sidebar a {
  display: block;
  text-decoration: none;
  color: #333;
  padding: 8px 10px;
  margin: 6px 0;
  border-radius: 8px;
}
.sidebar a:hover, .sidebar a.active {
  background: #ffe6d9;
  font-weight: bold;
}
.sidebar button {
  width: 100%;
  padding: 10px;
  background: #ff7f50;
  color: white;
  border: none;
  border-radius: 8px;
  cursor: pointer;
  margin-top: 10px;
}
.sidebar button:hover {background: #ff5722;}

.main {
  flex: 1;
  background: #fff;
  border-radius: 10px;
  padding: 20px;
  box-shadow: 0 4px 12px rgba(0,0,0,0.1);
}
.top {
  display: flex;
  justify-content: space-between;
  align-items: center;
}
.top img { height: 40px; }
.top button {
  background: #ff7f50;
  border: none;
  padding: 10px 14px;
  color: #fff;
  border-radius: 8px;
  cursor: pointer;
}
.top button:hover { background: #ff5722; }

.calendar-grid {
  display: grid;
  grid-template-columns: 280px 1fr;
  gap: 20px;
  margin-top: 20px;
}
.small-cal, .big-cal {
  background: #fafafa;
  border-radius: 10px;
  padding: 10px;
  box-shadow: 0 4px 10px rgba(0,0,0,0.1);
}
.small-cal h4, .big-cal h4 {
  text-align: center;
  margin: 10px 0;
}
.small-cal table, .big-cal table {
  width: 100%;
  border-collapse: collapse;
  text-align: center;
}
.small-cal td, .big-cal td {
  padding: 8px;
  border-radius: 6px;
}
.small-cal td.has-event {
  background: #ffe6d9;
  font-weight: bold;
}
.big-cal td.event-day {
  background: #fff5f0;
  border: 1px solid #ffccb8;
}
.big-cal .event {
  background: #fff;
  border: 1px solid #ffccb8;
  border-radius: 8px;
  margin: 5px;
  padding: 6px;
  box-shadow: 0 3px 6px rgba(0,0,0,0.05);
}
.big-cal .event strong {
  color: #ff5722;
}
.big-cal .event small {
  color: #777;
  display: block;
}

/* –°–µ–∫—Ü–∏–∏ */
.section { display: none; }
.section.active { display: block; }
.events-list {
  display: grid;
  grid-template-columns: repeat(auto-fit,minmax(220px,1fr));
  gap: 14px;
}
.card {
  background: #fff;
  border: 1px solid #f0f0f0;
  border-radius: 10px;
  padding: 12px;
  box-shadow: 0 2px 10px rgba(0,0,0,0.07);
}
.card button {
  background: #ff7f50;
  color: white;
  border: none;
  padding: 8px 10px;
  border-radius: 8px;
  cursor: pointer;
}
.card button:hover {background: #ff5722;}
</style>
</head>
<body>

<div class="top">
  <img src="{% static 'img/yessenov.png' %}" alt="Yessenov">
  <img src="{% static 'img/kini.png' %}" alt="KINI">
</div>

<div class="container">
  <div class="sidebar">
    <h3>–ú–µ–Ω—é</h3>
    <a href="#" class="active" data-view="calendar">üìÖ –ö–∞–ª–µ–Ω–¥–∞—Ä—å</a>
    <a href="#" data-view="events">üìå –ú–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è</a>
    <a href="#" data-view="my">‚≠ê –ú–æ–∏ —Å–æ–±—ã—Ç–∏—è</a>
    <a href="#" data-view="notif">üîî –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</a>
    <button id="bookBtn">+ –ó–∞–±—Ä–æ–Ω–∏—Ä–æ–≤–∞—Ç—å</button>
    {% if request.user.is_superuser %}
      <a href="/create-event/" class="btn" style="display:block;text-align:center;margin-top:8px;">–°–æ–∑–¥–∞—Ç—å</a>
    {% endif %}
    <a href="/logout/">üö™ –í—ã–π—Ç–∏</a>
  </div>

  <div class="main">
    <section id="calendar" class="section active">
      <div class="calendar-grid">
        <div class="small-cal">
          <h4>–ú–∏–Ω–∏-–∫–∞–ª–µ–Ω–¥–∞—Ä—å</h4>
          <table id="miniCal"></table>
        </div>
        <div class="big-cal">
          <h4>–ë–æ–ª—å—à–æ–π –∫–∞–ª–µ–Ω–¥–∞—Ä—å</h4>
          <table id="bigCal"></table>
        </div>
        </div>
    </section>

    <section id="events" class="section">
      <h2>–í—Å–µ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è</h2>
      <div class="events-list" id="eventsList"></div>
    </section>

    <section id="my" class="section">
      <h2>–ú–æ–∏ —Å–æ–±—ã—Ç–∏—è</h2>
      <div class="card"><p>–ü–æ–∫–∞ –ø—É—Å—Ç–æ. –ó–∞–±—Ä–æ–Ω–∏—Ä—É–π—Ç–µ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–µ!</p></div>
    </section>

    <section id="notif" class="section">
      <h2>–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</h2>
      <div class="card"><p>–ù–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π.</p></div>
    </section>
  </div>
</div>

<script>
const EVENTS = [
  {id:1, title:"–û—Å–µ–Ω–Ω–∏–π –±–∞–ª", date:"2025-10-16", time:"18:00", place:"–ê–∫—Ç–æ–≤—ã–π –∑–∞–ª"},
  {id:2, title:"–•—ç–ª–ª–æ—É–∏–Ω", date:"2025-10-31", time:"19:00", place:"–°—Ç—É–¥–∫–ª—É–±"},
  {id:3, title:"–í—Å—Ç—Ä–µ—á–∞ —Å –¥–µ–∫–∞–Ω–æ–º", date:"2025-10-20", time:"15:00", place:"–ö–æ–Ω—Ñ. –∑–∞–ª"},
  {id:4, title:"–ö–∏–Ω–æ–∑–∞–ª", date:"2025-10-22", time:"20:00", place:"–ö–∏–Ω–æ–∑–∞–ª"},
  {id:5, title:"–Ø—Ä–º–∞—Ä–∫–∞ –≤–∞–∫–∞–Ω—Å–∏–π", date:"2025-11-01", time:"11:00", place:"–ì–ª–∞–≤–Ω—ã–π –∫–æ—Ä–ø—É—Å"},
  {id:6, title:"IT –•–∞–∫–∞—Ç–æ–Ω", date:"2025-11-25", time:"09:00", place:"Coworking Hub"},
  {id:7, title:"–°–ø–æ—Ä—Ç–∏–≤–Ω—ã–π —Ç—É—Ä–Ω–∏—Ä", date:"2025-11-10", time:"17:00", place:"–°–ø–æ—Ä—Ç–∑–∞–ª"},
  {id:8, title:"–≠–∫–æ-–≤–æ–ª–æ–Ω—Ç—ë—Ä—ã", date:"2025-11-12", time:"10:00", place:"–î–≤–æ—Ä –∫–∞–º–ø—É—Å–∞"},
  {id:9, title:"–ö–ª—É–± –¥–µ–±–∞—Ç–æ–≤", date:"2025-11-18", time:"16:00", place:"–ê—É–¥. 203"},
  {id:10, title:"–ö—É—Ä—Å—ã Python", date:"2025-11-20", time:"18:30", place:"–õ–∞–±. 1"},
];

// ===== –°–µ–∫—Ü–∏—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è =====
document.querySelectorAll(".sidebar a[data-view]").forEach(a=>{
  a.onclick = e=>{
    e.preventDefault();
    document.querySelectorAll(".sidebar a").forEach(x=>x.classList.remove("active"));
    a.classList.add("active");
    document.querySelectorAll(".section").forEach(s=>s.classList.remove("active"));
    document.getElementById(a.dataset.view).classList.add("active");
  };
});

// ===== –ú–∏–Ω–∏ –∏ –ë–æ–ª—å—à–æ–π –∫–∞–ª–µ–Ω–¥–∞—Ä—å =====
function renderCalendar() {
  const now = new Date();
  const year = now.getFullYear();
  const month = now.getMonth();
  const days = new Date(year, month+1, 0).getDate();

  let mini = "<tr>";
  for (let d=1; d<=days; d++) {
    const date = ${year}-${String(month+1).padStart(2,"0")}-${String(d).padStart(2,"0")};
    const ev = EVENTS.find(e=>e.date===date);
    mini += <td class="${ev?'has-event':''}">${d}</td>;
    if (d%7===0) mini+="</tr><tr>";
  }
  document.getElementById("miniCal").innerHTML = mini + "</tr>";

  // –ë–æ–ª—å—à–æ–π –∫–∞–ª–µ–Ω–¥–∞—Ä—å
  let big = "";
  for (let d=1; d<=days; d++) {
    const date = ${year}-${String(month+1).padStart(2,"0")}-${String(d).padStart(2,"0")};
    const evs = EVENTS.filter(e=>e.date===date);
    if (evs.length>0) {
      big += <tr><td class="event-day">${d}<br> +
             evs.map(e=>`<div class='event'><strong>${e.title}</strong><small>${e.time} ‚Ä¢ ${e.place}</small>
             <button onclick="location.href='/events/${e.id}/register/'">–ó–∞–±—Ä–æ–Ω–∏—Ä–æ–≤–∞—Ç—å</button></div>`).join('') +
             </td></tr>;
    } else {
      big += <tr><td>${d}</td></tr>;
    }
  }
  document.getElementById("bigCal").innerHTML = big;
}
renderCalendar();

// ===== –°–ø–∏—Å–æ–∫ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π =====
const list = document.getElementById("eventsList");
list.innerHTML = EVENTS.map(e=>`
<div class='card'>
  <h4>${e.title}</h4>
  <p>${e.date} ‚Ä¢ ${e.time} ‚Ä¢ ${e.place}</p>
  <button onclick="location.href='/events/${e.id}/register/'">–ó–∞–±—Ä–æ–Ω–∏—Ä–æ–≤–∞—Ç—å</button>
</div>`).join("");

// –ë—ã—Å—Ç—Ä–∞—è –±—Ä–æ–Ω—å
document.getElementById("bookBtn").onclick = ()=>{
  const soon = EVENTS[0];
  location.href = /events/${soon.id}/register/;
};
</script>
</body>
</html>